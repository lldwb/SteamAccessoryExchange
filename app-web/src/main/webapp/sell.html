<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!-- vue -->
    <script src="js/vue.js"></script>
    <script src="js/vue-router.js"></script>
    <!-- jquery -->
    <script src="js/jquery.min.js"></script>
    <!-- element-ui -->
    <!-- 引入样式 -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- 引入组件库 -->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <!-- 引入样式(图标有问题) -->
    <!--<link rel="stylesheet" href="css/element-ui_index.css">-->
    <!-- 引入组件库 -->
    <!--<script src="js/element-ui_index.js"></script>-->

</head>
<style>
    .bg-purple {
        background: #1e2329;
        /*filter:opacity(25%);*/
    }
    .grid-content {
        min-height: 36px;
        margin: 0px;
        padding: 0px;
        background: white;
        filter: opacity(0%);
    }
    .styles{
        width: 100%;
        height:180px;
    }
    .imgs{
        width: 100%;
        height:180px;
        display:block;
    }
</style>
<body>
<div id="app" style="background-image: url(img.png);background-size: cover; width: 100%;height: 500px;">
    <el-row>
        <el-col :span="4"><div class="grid-content "></div></el-col>
        <el-col :span="3">
        <div class="bg-purple" style="background-color:rgba(30,35,41,0.7);">
            <img class="imgs" :src="src">
        </div>
        </el-col>

        <el-col :span="13">
            <!--rgba ：设置透明-->
        <div class=" bg-purple styles" style="background-color:rgba(30,35,41,0.7); ">
            <div style="padding-top: 15px; color: white;opacity: 1.0"><div>流浪者匕首（★） | 表面淬火 (久经沙场)
                 <div style="float: right;padding-right: 15px">
                    所属武器箱<i class="el-icon-suitcase-1"></i>
                    收藏<i class="el-icon-star-off"></i>
                </div>
            </div>
            </div>
            <div style="padding-top: 15px;color: white">品质 |隐秘 类别 |★ 类型 |匕首</div>
            <el-divider></el-divider>
            <div style="color: white"><div>参考价格 | ¥ 4394.96($ 612.12) 查看Steam市场
                <div style="float: right;padding-right: 15px">
                    <el-button type="info">我要出售</el-button>
                    <el-button type="danger">我要求购</el-button>
                </div>
            </div>
            </div>
        </div>
        </el-col>

        <el-col :span="4"><div class=" grid-content "></div></el-col>
    </el-row>

    <el-row style="padding-top: 1px">
        <el-col :span="4"><div class="grid-content "></div></el-col>
        <el-col :span="16" class="bg-purple" style="padding: 10px 44px">
            <el-button type="info" style="background:#1e2329;border-color: #899ab9;" plain>崭新出厂</el-button>
            <el-button type="info" style="background:#1e2329;border-color: #899ab9;" plain>略有磨损</el-button>
            <el-button type="info" style="background:#1e2329;border-color: #899ab9;" plain>久经沙场</el-button>
            <el-button type="info" style="background:#1e2329;border-color: #899ab9;" plain>破损不堪</el-button>
            <el-button type="info" style="background:#1e2329;border-color: #899ab9;" plain>战痕累累</el-button>
            <el-button type="info" style="background:#1e2329;border-color: #899ab9;" plain icon="el-icon-sort">StatTrak™</el-button>
        </el-col>
        <el-col :span="4"><div class="grid-content "></div></el-col>
    </el-row>

    <el-row style="padding-top: 20px">
        <el-col :span="4"><div class="grid-content "></div></el-col>
        <el-col :span="16">
            <el-menu
                    :default-active="activeIndex"
                    class="el-menu-demo"
                    mode="horizontal"
                    background-color="#282727FF"
                    text-color="#90969C"
                    active-text-color="#FFFFFF">
                <el-menu-item index="1" @click="updSell">出售</el-menu-item>
                <el-menu-item index="2" @click="updBuy">求购</el-menu-item>
            </el-menu>

        </el-col>
        <el-col :span="4"><div class="grid-content "></div></el-col>
    </el-row>

    <el-row >
        <el-col :span="4"><div class="grid-content "></div></el-col>
        <!--出售-->
        <el-col :span="16"  v-if="determine" >
            <!-- 出售模块表格-->
            <template>
                <el-table
                        :data="tableSellData"
                        style="width: 100%">
                    <el-table-column
                            label="出售ID"
                            prop="sellId">
                    </el-table-column>
                    <el-table-column
                            label="价格"
                            prop="sellPrice">
                    </el-table-column>
                    <el-table-column
                            label="描述"
                            prop="sellDescribe">
                    </el-table-column>
                    <el-table-column
                            label="商品id"
                            prop="coId">
                    </el-table-column>
                    <el-table-column
                            label="用户id"
                            prop="userId">
                    </el-table-column>
                    <el-table-column
                            label="操作">
                        <template slot-scope="scope">
                            <el-button
                                    type="primary"
                                    size="mini"
                                    @click="handleEdit(scope.$index, scope.row)">购买</el-button>
                        </template>
                    </el-table-column>
                </el-table>
            </template>
            <!-- 表格分页 -->
            <!-- pager-count pager-count属性可以设置最大页码按钮数,超出折叠,默认为7-->
            <!-- 注意：若数据是后端接口返回的则此时:total="pageCount"-->
            <el-pagination
                    @size-change="handleSizeChange"
                    @current-change="handleCurrentChange"
                    :pager-count="7"
                    :current-page="currentPage"
                    :page-sizes="[1, 3, 5, 10]"
                    :page-size="pagesize"
                    layout="total, sizes, prev, pager, next, jumper"
                    :total="pageSellCount"
                    background
                    style=" margin-top: 20px"
            >
            </el-pagination>

        </el-col>
        <!--求购-->
        <el-col :span="16"  v-else >
            <!--求购模块表格-->
            <template>
                <el-table
                        :data="tableBuyData"
                        style="width: 100%">
                    <el-table-column
                            label="求购ID"
                            prop="wtbId">
                    </el-table-column>
                    <el-table-column
                            label="价格"
                            prop="wtbPrice">
                    </el-table-column>
                    <el-table-column
                            label="数量"
                            prop="wtbNumber">
                    </el-table-column>
                    <el-table-column
                            label="总价"
                            prop="wtbTotal">
                    </el-table-column>
                    <el-table-column
                            label="商品id"
                            prop="coId">
                    </el-table-column>
                    <el-table-column
                            label="用户id"
                            prop="userId">
                    </el-table-column>
                    <el-table-column
                            label="操作">
                        <template slot-scope="scope">
                            <el-button
                                    type="primary"
                                    size="mini"
                                    @click="handleEdit(scope.$index, scope.row)">供应</el-button>
                        </template>
                    </el-table-column>
                </el-table>
            </template>
            <!-- 表格分页 -->
            <!-- pager-count pager-count属性可以设置最大页码按钮数,超出折叠,默认为7-->
            <!-- 注意：若数据是后端接口返回的则此时:total="pageCount"-->
            <el-pagination
                    @size-change="handleSizeChange"
                    @current-change="handleCurrentChange"
                    :pager-count="7"
                    :current-page="currentPage"
                    :page-sizes="[1, 3, 5, 10]"
                    :page-size="pagesize"
                    layout="total, sizes, prev, pager, next, jumper"
                    :total="pageBuyCount"
                    background
                    style=" margin-top: 20px"
            >
            </el-pagination>
        </el-col>
        <el-col :span="4"><div class="grid-content "></div></el-col>
    </el-row>


</div>
</body>
</html>
<script>
    const getSell = vueRouter => {
        $.ajax({
            url: "http://localhost:8080/service_api_war/getSell",
            dataType: 'JSON',  // 请求方式为json
            data: {
                numberOf: vueRouter.currentPage,
                limit: vueRouter.pagesize
            },
            success(result) {
                vueRouter.tableSellData = result.data
                vueRouter.pageSellCount = result.count
                $.ajax({
                    url: "http://localhost:8080/service_api_war/getBuy",
                    dataType: 'JSON',  // 请求方式为json
                    data: {
                        numberOf: vueRouter.currentPage,
                        limit: vueRouter.pagesize
                    },
                    success(result) {
                        vueRouter.tableBuyData = result.data
                        vueRouter.pageBuyCount = result.count
                        console.log(vueRouter.tableBuyData)
                    },
                    error() {
                        console.log("求购失败")
                    }
                })
            },
            error() {
                console.log("出售失败")
            },
        })
    }

    new Vue({
        el:"#app",
        data() {
            return {
                tableSellData:[],
                tableBuyData:[],
                src:"https://g.fp.ps.netease.com/market/file/5dd3ed5e143cfa13aa3b05c8CC7lCrGs02",
                currentPage: 1,  //默认初始页
                pagesize: 10, //每页默认显示的数据
                pageSellCount: 0, //出售数据的总条数,如果数据是后端接口返回的，则此值需修改
                pageBuyCount:0,
                activeIndex: '1',
                determine:true
            }
        },
        methods : {
            //改变每页容纳的数据量
            handleSizeChange: function (size) {
                this.pagesize = size;
                getSell(this)
            },
            //切换页码
            handleCurrentChange: function (currentPage) {
                this.currentPage = currentPage;
                getSell(this)
            },
            updSell(){
                this.currentPage=1;
                this.pagesize=10;
                getSell(this)
                this.determine=true;
                },
            updBuy(){
                this.currentPage=1;
                this.pagesize=10;
                getSell(this)
                this.determine=false;},
            handleEdit(index, row) {
                console.log(index, row);
            },
        } ,
        mounted() {
            getSell(this)
        }
    })
</script>